<script>
    const nome = document.querySelector('#first-name');
    const sobrenome = document.querySelector('#last-name');
    const email = document.querySelector('#email');
    const senha = document.querySelector('#password');
    const form = document.querySelector('form');
    nome.addEventListener('input', verificaSePrimeiraLetraMaiuscula);
    sobrenome.addEventListener('input', verificaSePrimeiraLetraMaiuscula);
    senha.addEventListener('input', validarSenha);
    email.addEventListener('input', ({target}) => {
        const {value, id} = target;
        const elemento = retornaElementoPeloId(id);
        value.includes('@') ? validarElemento(elemento) : invalidarElemento(elemento, 'E-mail inválido!');
    });
    form.addEventListener('submit', pegarAmostra );
    function verificaSePrimeiraLetraMaiuscula(event) {
        const {value, id} = event.target;
        
        if(!value){
            return;
        }
        const elemento = retornaElementoPeloId(id);
        value.trim()[0] === value.trim()[0].toUpperCase() ? validarElemento(elemento) : invalidarElemento(elemento, 'A primeira letra deve ser maiuscula!');
    }

    let temNumero = false;
    let temLetra = false
    function validarSenha (event) {
        let temNumero = false;
        let temLetra = false
        const {value, id} = event.target;

        const elemento = retornaElementoPeloId(id);
        if(value.length < 8) {
            return invalidarElemento(elemento, 'A senha precisar ter mais de 8 caracters!');
        }            

        for (const caracters of value) {
            isNaN(caracters.trim()) ? temLetra = true : temNumero = true;
            if(!isNaN(caracters.trim())){
                temNumero = true;
                continue;
            }

            if(caracters.toUpperCase() !== caracters.toLowerCase()){
                temLetra = true
            }
        }
        temNumero && temLetra ? validarElemento(elemento) : invalidarElemento(elemento, 'A senha precisa ter pelo menos 1 letra e 1 número!')            
    }
    function pegarAmostra(event) {      
        const elementosDoForm = [nome,sobrenome, senha];
        for (const elemento of elementosDoForm) {
            if (!elemento.value){
                invalidarElemento(elemento, 'Esse campo é obrigatório!')
                return event.preventDefault();
            }
        }
    }
    function retornaElementoPeloId(id) {
        return document.querySelector(`#${id}`);
    }
    function invalidarElemento(elemento, mensagem) {
        elemento.setCustomValidity(mensagem);
    }
    function validarElemento(elemento) {
        elemento.setCustomValidity('');
    }
</script>
